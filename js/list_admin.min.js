var PDbListAdmin=function(a){var e=!1,f=a("#list_form"),h=a("#select_count"),g=a("#apply_button").prop("disabled",!0).addClass("unarmed"),k=a("#checkall"),u=a('<input type="hidden" name="submit-button" />'),l=a("#pdb-with_selected-1"),p,m=function(b){g.attr("class",b?g.attr("class").replace("unarmed","armed"):g.attr("class").replace("armed","unarmed")).prop("disabled",b?!1:!0)},q=function(b){var a=h.val();!0===b?(k.prop("checked",f.find(".delete-check:not(:checked)").length?!1:!0),a++):(k.prop("checked",
!1),a--);0>a&&(a=0);m(0<a);h.val(a)},v=function(){!1===e?e=!0:(e=!1,m(!1));f.find(".delete-check").each(function(){a(this).prop("checked",e);q(e)})},t=function(b){b=b.target?a(b.target):a(b);var c=b.closest(".list-controls").find(".mass-edit-control"),d=b.closest(".list-controls").find(".file-delete-preference-selector");switch(b.val()){case mass_editL10n.edit_action:d.hide(300);r(b);c.show(300);break;case "delete":d.show(300);c.hide(300);break;default:c.hide(300),d.hide(300)}},r=function(b){var c=
(b.target?a(b.target):a(b)).closest(".list-controls"),d=c.find(".mass-edit-input");d.find(".field-input-label, .field-input").fadeTo(300,0,function(){d.addClass("changeout")});d.append(p);b={action:mass_editL10n.action};c=c.find('[name="'+mass_editL10n.selector+'"]').val();b[mass_editL10n.selector]=c;b[c]=a(".mass-edit-input [name="+c+"]").val();a.post(ajaxurl,b,function(a){d.html(a.input);d.find(".field-input-label, .field-input").fadeTo(300,1);d.removeClass("changeout");PDbOtherSelect.init();PDbDatepicker&&
PDbDatepicker.init()})},n=a("<div/>").dialog({dialogClass:"confirmation-dialog participants-database-confirm",modal:!0,zIndex:1E4,autoOpen:!1,width:"auto",resizable:!1,buttons:[{icon:"dashicons dashicons-yes",click:function(){f.prepend(u.clone().val(list_adminL10n.apply));m(!0);e=!1;if("export"===l.val()){var b=a("form.csv-export"),c=new FormData(f[0]);b.find("[name=export_selection]").length?b.find("[name=export_selection]").val(c.getAll("pid[]").toString()):b.prepend(a("<input>",{type:"hidden",
name:"export_selection",value:c.getAll("pid[]").toString()}));b.submit();n.dialog("close").html("")}else f.submit(),n.dialog("destroy")}},{icon:"dashicons dashicons-no-alt",click:function(){e=!0;a(this).dialog("close").html("")}}]});return{init:function(){g.on("click",function(b){b.preventDefault();var c=parseInt(h.val(),10);b=1<c?"plural":"singular";var d=a("[name=with_selected]").val();c=!list_adminL10n.unlimited_actions.includes(d)&&c>parseInt(list_adminL10n.send_limit)?a('<h4 class="dashicons-before dashicons-warning"/>').append(list_adminL10n.apply_confirm.recipient_count_exceeds_limit.replace("{limit}",
list_adminL10n.send_limit)):"";n.append(a("<h3/>").append(list_adminL10n.apply_confirm[d][b])).append(c).dialog("open").find("a").blur()});p=mass_editL10n.spinner;l.on("change",t);t(l);a('[name="'+mass_editL10n.selector+'"]').on("change",r);k.click(v);a(".delete-check").on("click",function(){q(a(this).prop("checked"))});a("#list_filter_count").change(a.debounce(500,function(){a(this).closest("form").submit()}))}}}(jQuery);jQuery(function(){PDbListAdmin.init()});