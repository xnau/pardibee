PDbListFilter=function(b){var f=!1,k=b(".pdb-searchform .pdb-error"),l=b('.sort_filter_form[data-ref="update"]'),n=b('.sort_filter_form[data-ref="remote"]'),d={filterNonce:PDb_ajax.filterNonce,postID:PDb_ajax.postID},g=function(a,e){e=e||!1;a.preventDefault?a.preventDefault():a.returnValue=!1;var c=b(a.target).closest("div[id^=participants-list-], .pdb-search");k=c.find(".pdb-searchform .pdb-error");l=c.find('.sort_filter_form[data-ref="update"]');n=c.find('.sort_filter_form[data-ref="remote"]');
m();c=b(a.target);c=c.is("a")?c:c.closest("a");a=b(a.target);var q=a.closest("."+PDb_ajax.prefix+"searchform").find(".search_field_error"),g=a.closest("."+PDb_ajax.prefix+"searchform").find(".value_error");d.target_instance=d.instance_index||"";d.submit=a.data("submit");switch(d.submit){case "search":d.listpage="1";b('[name^="search_field"]').PDb_checkInputs("none")&&(q.show(),f=!0);!PDb_ajax.allow_empty_term&&b('[name^="value"]').PDb_checkInputs("")&&(g.show(),f=!0);if(f){k.show();return}break;case "clear":b('select[name^="search_field"]').PDb_clearInputs("none");
b('input[name^="value"]').PDb_clearInputs("");m();d.listpage="1";break;case "page":d.action=c.closest("div").data("action");d.listpage=c.data("page");break;case "sort":break;default:return}e?"clear"!==d.submit&&(0===a.closest("form").find("[name=submit_button]").length&&a.closest("form").append(b("<input>",{type:"hidden",name:"submit_button",value:a.val()})),a.closest("form").submit()):(a.PDb_processSubmission(),b("html").trigger("pdbListFilterComplete"))},r=function(a){g(a,!0)},t=function(a){b(a.target).data("submit",
"page");var e=b(a.target).closest(".wrap.pdb-list").prop("class").match(/pdb-instance-(\d+)/);d.instance_index=e[1];g(a)},m=function(){k.hide().children().hide();f=!1},u=function(){var a=b("#participants-list-"+d.instance_index);a.length&&a.height()>b(window).innerHeight()&&b("html, body").animate({scrollTop:a.offset().top},500)},p=function(a,b){var c=encodeURI(a.val());a=a.attr("name");var d=a.match(/\[\]$/);a=a.replace("[]","");d&&"string"===typeof b[a]&&(b[a]=[b[a]]);"object"===typeof b[a]?b[a][b[a].length]=
c:b[a]=c},v=function(a){var e=b(".pdb-list.pdb-instance-"+d.instance_index),c=e.length?e:b(".pdb-list").first(),g=c.find(".pdb-pagination"),f=a.closest("fieldset, ul, div"),k=b(PDb_ajax.loading_indicator).clone();b.ajax({type:"POST",url:PDb_ajax.ajaxurl,data:d,beforeSend:function(){g.find("a").prop("disabled",!0);f.after(k)},success:function(e,h){if(/^failed/.test(e))switch(d.submit){case "page":h=document.createElement("a");h.href=window.location.href;window.location.href=h.protocol+"//"+h.hostname+
a.attr("href");break;default:l.append('<input type="hidden" name="submit_button" value="'+d.submit+'" /> ').submit()}e=b(e);h=e.find(".pdb-pagination");var f=e.find(".list-container").length?e.find(".list-container"):e;e.PDb_idFix();f.find("a.obfuscate[data-email-values]").each(function(){b(this).PDb_email_obfuscate()});c.find(".list-container").replaceWith(f);g.remove();h.length&&h.each(function(){(c.find(".list-container + .pdb-pagination").length?c.find(".list-container + .pdb-pagination").last():
c.find(".list-container")).after(this)});k.remove();g.find("a").prop("disabled",!1);b("html").trigger("pdbListAjaxComplete")},error:function(a,b,c){console.log("Participants Database JS error status:"+b+" error:"+c)}})};b.fn.PDb_idFix=function(){this.find("#pdb-list").addClass("list-container").removeAttr("id");this.find("#sort_filter_form").addClass("sort_filter_form").removeAttr("id")};b.fn.PDb_checkInputs=function(a){var d=this.length,c=0;this.each(function(){b(this).val()===a&&c++});return c===
d};b.fn.PDb_clearInputs=function(a){this.each(function(){b(this).val(a)})};b.fn.PDb_processSubmission=function(){var a=this.closest("form");a.length||(a=this.closest(".pdb-list").find(".sort_filter_form"));a.find('input:not(input[type="submit"],input[type="radio"]), select').each(function(){p(b(this),d)});a.find('input[type="radio"]:checked').each(function(){p(b(this),d)});v(this)};return{run:function(){"undefined"===typeof PDb_ajax.prefix&&(PDb_ajax.prefix="pdb-");b(".wrap.pdb-list").PDb_idFix();
m();l.on("click",'[type="submit"]',g);n.on("click",'[type="submit"]',r);b(".pdb-list").on("click",".pdb-pagination a",t);b("html").on("pdbListAjaxComplete",u)}}}(jQuery);jQuery(function(){PDbListFilter.run()});